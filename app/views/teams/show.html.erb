<p id="notice"><%= notice %></p>

<h2>Team <%= link_to "#{@team.company}", @team.website, :target => "_blank" %></h2>
  
<p>
  <b>Company type:</b>
  <%= @team.company_type %>
</p>

<p>
  <b>Size:</b>
  <%= @team.size %>
</p>

<p>
  <b>Team Members:</b>
</p>
	 
	<table>
		<tr>
		<th> Name </th>
		<th> Team Leader </th>
	 	<th> Self-Described Biker Type </th>
		<th> Commutes </th>
		<th> Current Mileage </th>
		</tr>
		<% teammiles = 0 %>
		<% @team.users.each do |user| %>
			<% miles = 0 %>
			<% user.commutes.each do |commute| %>
					<% miles = miles + commute.mileage %>
			<% end %>
			<% teammiles = teammiles + miles  %>			
		<tr>
		<td> <%= link_to "#{user.fname}" " #{user.lname}", user_url(user.id)  %> </td>
		<% if user.isleader == true %>
		<td> Y </td>		
		<% else %>
		<td>  </td>	
		<% end %>	
		<td> <%= user.bikerclass %> </td>
		<td> <%= user.commutes.count %> </td>
		<td> <%= miles %> </td>		
		<td> <%= link_to "View Commutes (#{user.commutes.count})", user_commutes_url(user.id) %> </td>		
		<% if session[:user_id] %>
			<% if User.find(session[:user_id]).isleader == true ||  User.find(session[:user_id]) == user %>
			<td> <%= link_to "Add Commute", new_commute_url(:user_id => user.id) %> </td>				
			<% end %>	
		<% end %>	
		</tr>
  <% end %>
	</table>
	
<br>

	<p>
	  <b>Current Team Miles:</b>
	  <%= (teammiles * 100).round.to_f / 100 %>
	</p>

<br>

<%= link_to 'Edit', edit_team_path(@team) %> |
<%= link_to 'Back', teams_path %>
